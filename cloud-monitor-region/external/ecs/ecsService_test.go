package ecs

import (
	"code.cestc.cn/ccos-ops/cloud-monitor/cloud-monitor-region/logger"
	"encoding/json"
	"fmt"
	"testing"
)

func TestHttpClient(t *testing.T) {
	var str = "{\n    \"msg\": \"调用成功\",\n    \"code\": \"0\",\n    \"data\": {\n        \"total\": 1,\n        \"rows\": [\n            {\n                \"defaultPass\": null,\n                \"bandWidth\": null,\n                \"data\": null,\n                \"orderId\": null,\n                \"portInfoList\": null,\n                \"networkName\": null,\n                \"enablePublicIp\": null,\n                \"fixedIp\": null,\n                \"crmAttrList\": [\n                    {\n                        \"attrCode\": \"name\",\n                        \"attrValue\": \"cecloud-ecs-64449\",\n                        \"attrName\": \"名称\"\n                    },\n                    {\n                        \"attrCode\": \"uid\",\n                        \"attrValue\": \"ecs-cnynhkztuwt6ci\",\n                        \"attrName\": \"实例编码\"\n                    },\n                    {\n                        \"attrCode\": \"status\",\n                        \"attrValue\": \"2\",\n                        \"attrName\": \"实例状态\"\n                    },\n                    {\n                        \"attrCode\": \"cpu\",\n                        \"attrValue\": \"null\",\n                        \"attrName\": \"处理器核数\"\n                    },\n                    {\n                        \"attrCode\": \"ram\",\n                        \"attrValue\": \"null\",\n                        \"attrName\": \"内存\"\n                    },\n                    {\n                        \"attrCode\": \"disk\",\n                        \"attrValue\": \"null\",\n                        \"attrName\": \"系统盘大小\"\n                    },\n                    {\n                        \"attrCode\": \"templateUid\",\n                        \"attrValue\": \"faba325d-8414-4956-8594-cf85ce735237\",\n                        \"attrName\": \"实例规格uid\"\n                    },\n                    {\n                        \"attrCode\": \"imageUid\",\n                        \"attrValue\": null,\n                        \"attrName\": \"镜像uid\"\n                    },\n                    {\n                        \"attrCode\": \"networkUid\",\n                        \"attrValue\": \"vpc-ph9rva44i538\",\n                        \"attrName\": \"专有网uid\"\n                    }\n                ],\n                \"templateUid\": \"faba325d-8414-4956-8594-cf85ce735237\",\n                \"portId\": null,\n                \"sourceCode\": \"ccos\",\n                \"resourceCode\": \"cecloud\",\n                \"searchStr\": null,\n                \"serviceRecordId\": null,\n                \"createdTime\": \"2021-10-13 15:41:51\",\n                \"archType\": 2,\n                \"eipStatus\": null,\n                \"id\": 761,\n                \"imageType\": 1,\n                \"groupCode\": null,\n                \"ram\": null,\n                \"volumeInfoList\": null,\n                \"rootPass\": null,\n                \"virtualEnvType\": \"KVM\",\n                \"keyPairUid\": null,\n                \"imageName\": \"CentOS-7.1-amd64-20210915074509.raw\",\n                \"ip\": \"192.168.0.2\",\n                \"hostId\": \"ecs-cnynhkztuwt6ci\",\n                \"cpu\": null,\n                \"gpu\": null,\n                \"templateSpecInfoBean\": {\n                    \"data\": null,\n                    \"vcpu\": 2,\n                    \"bandwidth\": null,\n                    \"cpuModel\": \"x86\",\n                    \"type\": \"1\",\n                    \"templateFamilyId\": \"277\",\n                    \"gpu\": null,\n                    \"uid\": \"faba325d-8414-4956-8594-cf85ce735237\",\n                    \"sourceCode\": null,\n                    \"disk\": null,\n                    \"pps\": null,\n                    \"regionCode\": \"cc-wuhan-2\",\n                    \"resourceCode\": \"cecloud\",\n                    \"templateName\": null,\n                    \"name\": \"ecs.c1h.c2i_large\",\n                    \"templateFamilyName\": null,\n                    \"id\": 1357,\n                    \"zoneCode\": \"cc-wuhan-2a\",\n                    \"ram\": 4.0\n                },\n                \"portUid\": \"port-duiyvhy56lw1\",\n                \"eipUid\": null,\n                \"disk\": null,\n                \"internetChargeType\": null,\n                \"expireTime\": \"2021-11-13 23:59:59\",\n                \"oldStatus\": null,\n                \"imageUid\": null,\n                \"networkUid\": \"vpc-ph9rva44i538\",\n                \"zoneCode\": null,\n                \"status\": 2,\n                \"secGroupUidList\": null,\n                \"attachedNum\": null,\n                \"hostName\": \"cecloud-ecs-64449\",\n                \"regionName\": null,\n                \"icon\": null,\n                \"volumeFlag\": null,\n                \"payModel\": \"1\",\n                \"remark\": null,\n                \"eip\": null,\n                \"userCode\": \"210310011310200\",\n                \"subnetName\": null,\n                \"elasticIp\": null,\n                \"regionCode\": \"cc-wuhan-2\",\n                \"subnetIpInfo\": null,\n                \"osVersion\": null,\n                \"hardReboot\": null,\n                \"defaultUser\": \"root\",\n                \"zoneName\": \"可用区A\",\n                \"attach\": null,\n                \"sysDiskType\": null,\n                \"productType\": null,\n                \"reboot\": null,\n                \"updateTime\": null,\n                \"networkInfoBean\": {\n                    \"data\": \"{\\\"cidr\\\":\\\"192.168.0.0/16\\\",\\\"created_at\\\":\\\"2021-10-13T07:41:52.254Z\\\",\\\"external_subnets\\\":[{\\\"external_fixed_ip\\\":\\\"10.255.182.67\\\",\\\"subnet_id\\\":\\\"snet-3x9ucyl0m1q7\\\",\\\"subnet_type\\\":\\\"external\\\"},{\\\"external_fixed_ip\\\":\\\"10.255.181.67\\\",\\\"subnet_id\\\":\\\"snet-7v1msni1bmkj\\\",\\\"subnet_type\\\":\\\"share\\\"}],\\\"id\\\":\\\"vpc-ph9rva44i538\\\",\\\"instance_id\\\":\\\"\\\",\\\"name\\\":\\\"default_vpc\\\",\\\"routers\\\":[{\\\"router_id\\\":\\\"rtb-c70t8lecy31f\\\",\\\"router_type\\\":\\\"default\\\"}],\\\"status\\\":\\\"RUNNING\\\",\\\"tenant_id\\\":\\\"210310011310200\\\",\\\"updated_at\\\":\\\"2021-10-13T07:41:53.468Z\\\"}\",\n                    \"vlanid\": null,\n                    \"regionName\": null,\n                    \"description\": null,\n                    \"crmAttrList\": [\n                        {\n                            \"attrCode\": \"name\",\n                            \"attrValue\": \"default_vpc\",\n                            \"attrName\": \"名称\"\n                        },\n                        {\n                            \"attrCode\": \"uid\",\n                            \"attrValue\": \"vpc-ph9rva44i538\",\n                            \"attrName\": \"实例编码\"\n                        },\n                        {\n                            \"attrCode\": \"status\",\n                            \"attrValue\": \"0\",\n                            \"attrName\": \"实例状态\"\n                        },\n                        {\n                            \"attrCode\": \"networkType\",\n                            \"attrValue\": null,\n                            \"attrName\": \"网络类型\"\n                        },\n                        {\n                            \"attrCode\": \"physicalNetwork\",\n                            \"attrValue\": null,\n                            \"attrName\": \"物理网络\"\n                        },\n                        {\n                            \"attrCode\": \"cidr\",\n                            \"attrValue\": \"192.168.0.0/16\",\n                            \"attrName\": \"Ipv4网段\"\n                        }\n                    ],\n                    \"remark\": null,\n                    \"type\": \"default\",\n                    \"ccosVpcId\": null,\n                    \"userCode\": \"210310011310200\",\n                    \"uid\": \"vpc-ph9rva44i538\",\n                    \"regionCode\": \"cc-wuhan-2\",\n                    \"resourceCode\": \"cecloud\",\n                    \"physicalNetwork\": null,\n                    \"cidr\": \"192.168.0.0/16\",\n                    \"id\": 258,\n                    \"networkType\": null,\n                    \"subnetList\": null,\n                    \"externalSubnets\": null,\n                    \"userDefinedCidr\": null,\n                    \"routerUids\": null,\n                    \"subnetNum\": null,\n                    \"users\": null,\n                    \"lbNum\": null,\n                    \"ecsNum\": null,\n                    \"createTime\": \"2021-10-13 15:41:52\",\n                    \"routerNum\": null,\n                    \"name\": \"default_vpc\",\n                    \"tenantId\": null,\n                    \"status\": 0\n                },\n                \"statusList\": null,\n                \"subnetUid\": \"snet-izt3cj713yt5\",\n                \"secGroupUid\": null\n            }\n        ]\n    }\n}"
	var resp = []byte(str)
	result := &Response{}
	err := json.Unmarshal(resp, result)
	if err != nil {
		logger.Logger().Infof("error %v", err)
	}
	fmt.Print(result)
}
